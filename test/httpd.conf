### for proxying to the node server
LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so
LoadModule proxy_balancer_module /usr/lib/apache2/modules/mod_proxy_balancer.so
LoadModule proxy_http_module /usr/lib/apache2/modules/mod_proxy_http.so

LoadModule statsd_module /usr/lib/apache2/modules/mod_statsd.so

ErrorLog test/error.log
PidFile test/httpd.pid
User www-data

### a perl hash for comparing
LogFormat '{ TS => "%{%s}t", PATH => "%U", NOTE => "%{statsd}n", QS => "%q" }' statsd
CustomLog test/diag.log statsd

Listen 7000
NameVirtualHost *:7000
<VirtualHost  *:7000>

  <Proxy balancer://node>
    BalancerMember http://localhost:7001
  </Proxy>

  # Not enabled
  <Location /none>
    ProxyPass balancer://node
  </Location>

  <Location /basic>
    ProxyPass balancer://node
    Statsd On
    StatsdTimeUnit microseconds
  </Location>

  <Location /regex>
    ProxyPass balancer://node
    Statsd On
    StatsdTimeUnit microseconds
    StatsdExclude ^\d+$ exclude
  </Location>

  <Location /predefined>
    ProxyPass balancer://node
    Statsd On
    StatsdTimeUnit microseconds
    StatsdStat predefined
  </Location>

  <Location /presuf>
    ProxyPass balancer://node
    Statsd On
    StatsdTimeUnit microseconds
    StatsdPrefix prefix.
    StatsdSuffix .suffix
  </Location>

  <Location /nodot_presuf>
    ProxyPass balancer://node
    Statsd On
    StatsdTimeUnit microseconds
    StatsdPrefix prefix
    StatsdSuffix suffix
  </Location>


</VirtualHost>
